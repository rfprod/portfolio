<div
  fxLayout="row"
  [ngStyle]="{ height: '100%' }"
  fxLayoutAlign="stretch"
  *ngIf="data$ | async as data"
>
  <div fxFlex="1 1 auto" fxFlex.xs="100" fxLayout="row wrap">
    <mat-card
      fxFlex="100"
      class="marged"
      *ngIf="data.github"
      [ngStyle]="{ 'min-height': '100%', height: 'auto!important', width: '100%' }"
    >
      <mat-card-header>
        <div mat-card-avatar>
          <img
            [ngStyle]="{ height: '50px', width: 'auto!important' }"
            [src]="data.github?.avatar_url"
          />
        </div>
        <mat-card-title> {{ data.github?.login }}</mat-card-title>
        <mat-card-subtitle matTooltip="Current hireable status">
          <div *ngIf="data.github?.hireable">HIREABLE</div>

          <span *ngIf="!data.github?.hireable"> NOT HIREABLE </span>
        </mat-card-subtitle>
      </mat-card-header>

      <mat-card-content fxLayout="row wrap">
        <mat-chip-list>
          <mat-chip color="primary" *ngIf="data.github?.location" [selectable]="false" disabled>
            <mat-icon color="primary">my_location</mat-icon>
            &nbsp; Location: {{ data.github?.location }}
          </mat-chip>

          <mat-chip color="primary" *ngIf="data.github?.email" [selectable]="false" disabled>
            Email: {{ data.github?.email }}
          </mat-chip>

          <mat-chip color="primary" [selectable]="false" disabled>
            <mat-icon color="primary">library_books</mat-icon>
            &nbsp; Gists: {{ data.github?.public_gists }}
          </mat-chip>

          <mat-chip color="primary" [selectable]="false" disabled>
            <mat-icon color="primary">code</mat-icon>
            &nbsp; Repos: {{ data.github?.public_repos }}
          </mat-chip>

          <mat-chip color="primary" [selectable]="false" disabled>
            <mat-icon color="primary">date_range</mat-icon>
            &nbsp; Created: {{ data.github?.created_at | date }}
          </mat-chip>

          <mat-chip color="primary" [selectable]="false" disabled>
            <mat-icon color="primary">update</mat-icon>
            &nbsp; Updated: {{ data.github?.updated_at | date }}
          </mat-chip>
        </mat-chip-list>

        <div
          fxFlex="100"
          *ngIf="data.github?.company"
          fxLayout="row wrap"
          fxLayoutAlign="start center"
          fxLayoutGap="15px"
          [ngStyle]="{ padding: '15px 0 0 0' }"
        >
          <h4 fxFlex="100">Organizations</h4>

          <div
            fxFlex="100"
            fxLayout="row"
            fxLayoutAlign="start center"
            fxLayoutGap="15px"
            *ngIf="githubOrgs$ | async as orgs"
            [ngStyle]="{ padding: '0 15px' }"
          >
            <a
              *ngFor="let org of orgs"
              [href]="org.url"
              target="_blank"
              matTooltip="{{ org.login }}"
            >
              <img
                [ngStyle]="{ height: '42px', width: 'auto!important', 'border-radius': '5px' }"
                [src]="org.avatar_url"
              />
            </a>
          </div>
        </div>

        <div
          fxFlex="100"
          fxLayout="row wrap"
          fxLayoutAlign="start center"
          fxLayoutGap="15px"
          *ngIf="data.profiles"
          [ngStyle]="{ padding: '15px 0 0 0' }"
        >
          <h4 fxFlex="100">Profiles</h4>

          <div
            fxFlex="100"
            fxLayout="row wrap"
            fxLayoutAlign="start center"
            fxLayoutGap="15px"
            [ngStyle]="{ padding: '0 15px' }"
          >
            <a
              *ngFor="let profile of data.profiles"
              [href]="profile.link"
              [title]="profile.name"
              target="_blank"
            >
              <img
                [ngStyle]="{ height: '46px', width: 'auto!important' }"
                [src]="profile.imgRef"
                (load)="imgLoaded(profile.name)"
                (error)="imgError(profile.name)"
                (showImage)="showImage(profile.name)"
              />
            </a>
          </div>
        </div>

        <div
          fxFlex="100"
          fxLayout="row wrap"
          fxLayoutAlign="start center"
          [ngStyle]="{ padding: '15px 0 0 0' }"
        >
          <h4 fxFlex="100">Languages</h4>

          <div
            fxFlex="100"
            fxLayout="row wrap"
            fxLayoutAlign="start denter"
            fxLayoutGap="15px"
            [ngStyle]="{ padding: '0 15px' }"
          >
            <div
              fxFlex="0 1 auto"
              *ngFor="
                let githubLang of languageIcon$(data.githubLanguagesKeys) | async as githubLangs
              "
            >
              <div
                fxLayout="row"
                fxLayoutAlign="center center"
                [ngStyle]="{
                  height: '90px',
                  width: '90px',
                  opacity: '0.8',
                  margin: '0 10px 0 0'
                }"
                [ngStyle.lt-md]="{
                  height: '45px',
                  width: '45px',
                  opacity: '0.8',
                  margin: '0 10px 0 0'
                }"
                [ngStyle.xs]="{
                  height: '35px',
                  width: '35px',
                  opacity: '0.8',
                  margin: '0 10px 0 0'
                }"
                [matTooltip]="githubLang.key"
              >
                <img
                  [src]="githubLang.url"
                  [ngStyle]="{
                    'max-height': '90px',
                    height: 'auto!important',
                    width: '100%'
                  }"
                  [ngStyle.lt-md]="{
                    'max-height': '45px',
                    height: 'auto!important',
                    width: '100%'
                  }"
                  [ngStyle.xs]="{
                    'max-height': '35px',
                    height: 'auto!important',
                    width: '100%'
                  }"
                  (load)="imgLoaded(githubLang.key, true)"
                  (error)="imgError(githubLang.key, true)"
                  (showImage)="showImage(githubLang.key, true)"
                />
              </div>

              <div [ngStyle]="{ width: '100%', 'text-align': 'center', 'font-weight': 'bold' }">
                <div>{{ $any(data.githubLanguagesRate)[githubLang.key] }}%</div>
                <div class="mat-caption">{{ $any(data.githubLanguages)[githubLang.key] }}</div>
              </div>
            </div>
          </div>
        </div>

        <div fxFlex="100" [ngStyle]="{ padding: '15px 0 0 0' }">
          <app-activity [publicEvents]="publicEvents$ | async"></app-activity>
        </div>
      </mat-card-content>

      <mat-card-actions>
        <button
          *ngIf="data.github?.hireable"
          mat-icon-button
          (click)="showContactDialog()"
          color="primary"
          matTooltip="Send email"
        >
          <mat-icon class="material-icons">email</mat-icon>
        </button>
      </mat-card-actions>
    </mat-card>
  </div>
</div>
